<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® URGENT: Database Setup Required</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 800px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #dc2626;
            margin-bottom: 20px;
            font-size: 32px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h2 {
            color: #1f2937;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 24px;
        }
        .warning {
            background: #fef2f2;
            border-left: 4px solid #dc2626;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .success {
            background: #f0fdf4;
            border-left: 4px solid #16a34a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .step {
            background: #f9fafb;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
        }
        .step h3 {
            color: #4f46e5;
            margin-bottom: 10px;
            font-size: 18px;
        }
        code {
            background: #1f2937;
            color: #10b981;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .code-block {
            background: #1f2937;
            color: #d1d5db;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
        }
        .btn {
            display: inline-block;
            background: #4f46e5;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin: 10px 10px 10px 0;
            transition: all 0.3s;
        }
        .btn:hover {
            background: #4338ca;
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: #059669;
        }
        .btn-secondary:hover {
            background: #047857;
        }
        ul {
            margin: 15px 0;
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
            line-height: 1.6;
        }
        .error-explain {
            background: #fee;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            color: #c00;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® URGENT: Database Setup Required</h1>
        
        <div class="warning">
            <h3 style="color: #dc2626; margin-bottom: 10px;">‚ö†Ô∏è The 404 Error You're Seeing</h3>
            <div class="error-explain">
                Failed to load resource: the server responded with a status of 404<br>
                dmhca-worksheet.onrender.com/api/projections/8/subtasks
            </div>
            <p style="margin-top: 10px;"><strong>Why this happens:</strong> The database table <code>projection_subtasks</code> doesn't exist yet in Supabase. The backend routes are deployed, but they can't query a table that hasn't been created.</p>
        </div>

        <div class="success">
            <h3 style="color: #16a34a; margin-bottom: 10px;">‚úÖ Easy Fix - Takes 2 Minutes</h3>
            <p>You just need to run one SQL script in Supabase to create the new database tables.</p>
        </div>

        <h2>üìã Step-by-Step Instructions</h2>

        <div class="step">
            <h3>Step 1: Open Supabase Dashboard</h3>
            <ul>
                <li>Go to: <a href="https://supabase.com/dashboard" target="_blank">https://supabase.com/dashboard</a></li>
                <li>Log in if needed</li>
                <li>Select your project: <strong>dmhca-worksheet</strong></li>
            </ul>
            <a href="https://supabase.com/dashboard" target="_blank" class="btn">Open Supabase Dashboard</a>
        </div>

        <div class="step">
            <h3>Step 2: Open SQL Editor</h3>
            <ul>
                <li>In the left sidebar, click <strong>"SQL Editor"</strong></li>
                <li>Click the <strong>"New Query"</strong> button (top right)</li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 3: Copy the SQL Migration</h3>
            <p>Open this file in VS Code:</p>
            <div class="code-block">database/add-projection-subtasks.sql</div>
            <ul>
                <li>Select all content (Cmd/Ctrl + A)</li>
                <li>Copy it (Cmd/Ctrl + C)</li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 4: Run the SQL</h3>
            <ul>
                <li>Paste the SQL into the Supabase SQL Editor</li>
                <li>Click <strong>"Run"</strong> button (or press Cmd/Ctrl + Enter)</li>
                <li>Wait for success message: <strong>"Success. No rows returned"</strong></li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 5: Verify Table Created</h3>
            <ul>
                <li>In Supabase sidebar, click <strong>"Table Editor"</strong></li>
                <li>You should now see a new table: <code>projection_subtasks</code></li>
                <li>Click on it to verify columns exist</li>
            </ul>
        </div>

        <h2>üéâ After Running SQL</h2>
        
        <div class="success">
            <h3 style="color: #16a34a;">What You'll Be Able to Do:</h3>
            <ul>
                <li>‚úÖ Create Weekly Projections (Monday - Saturday)</li>
                <li>‚úÖ Create Monthly Projections (Full Month)</li>
                <li>‚úÖ Break down projections into subtasks</li>
                <li>‚úÖ Assign team members to specific subtasks</li>
                <li>‚úÖ Track estimated hours per subtask</li>
                <li>‚úÖ Set priorities and deadlines</li>
                <li>‚úÖ Update subtask status inline</li>
            </ul>
        </div>

        <h2>üß™ Test the Feature</h2>
        <ol>
            <li>Go to: <a href="https://dmhca-worksheet.vercel.app/projections" target="_blank">Work Projections Page</a></li>
            <li>Click <strong>"Add Projection"</strong></li>
            <li>Choose "Weekly" or "Monthly" type</li>
            <li>Fill in details and create</li>
            <li>Click <strong>"Work Breakdown & Team Assignment"</strong> to expand</li>
            <li>Click <strong>"Add Subtask & Assign Team Member"</strong></li>
            <li>Create a subtask with team member assigned</li>
        </ol>

        <a href="https://dmhca-worksheet.vercel.app/projections" target="_blank" class="btn btn-secondary">Go to Work Projections</a>

        <h2>üìä What the SQL Creates</h2>
        <ul>
            <li>‚úÖ <code>projection_type</code> column in <code>work_projections</code> table</li>
            <li>‚úÖ New <code>projection_subtasks</code> table with all fields</li>
            <li>‚úÖ Database indexes for fast queries</li>
            <li>‚úÖ Row Level Security (RLS) policies for access control</li>
            <li>‚úÖ Auto-update timestamps trigger</li>
        </ul>

        <div class="warning" style="margin-top: 30px;">
            <h3 style="color: #dc2626; margin-bottom: 10px;">üî¥ The 404 Error Will Continue Until SQL is Run</h3>
            <p>The backend is already deployed and working. The only thing missing is the database table. Once you run the SQL script, the 404 errors will disappear and the feature will work perfectly!</p>
        </div>

        <hr style="margin: 30px 0; border: 1px solid #e5e7eb;">
        
        <p style="text-align: center; color: #6b7280;">
            <strong>Need Help?</strong> Check the full deployment guide in: <code>PROJECTIONS-DEPLOYMENT.md</code>
        </p>
    </div>
</body>
</html>
